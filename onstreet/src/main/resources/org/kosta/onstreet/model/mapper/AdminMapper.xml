<?xml version="1.0" encoding="UTF-8"?>
<!-- Sql Mapper -->
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.kosta.onstreet.model.mapper.AdminMapper">

	<!-- authVO has a -->
	<resultMap type="authVO" id="memberList">
		<result column="id" property="memberVO.id"/>
		<result column="nickname" property="memberVO.nickName"/>
		<result column="address" property="memberVO.address"/>
		<result column="phone" property="memberVO.phone"/>
		<result column="email" property="memberVO.email"/>
		<result column="name" property="memberVO.name"/>
		<result column="age" property="memberVO.age"/>
		<result column="remove_user_date" property="memberVO.removeUserDate"/>
	</resultMap>
	
	<!-- 정지윤 -->
	<!-- 회원 수 -->
	<select id="getTotalMemberCount" resultType="int">
		select count(*) from os_member
	</select>
	
	<!-- 회원(ROLE_MEMBER) 리스트 불러오기 -->
	<select id="getManageMemberList" resultMap="memberList" parameterType="map">
		SELECT m.id,m.nickname,m.address,m.phone,m.email,m.name,m.age,a.auth_name
		FROM (SELECT row_number() over(order by id desc) as rnum,auth_name,id
		FROM os_auth) a,os_member m
		WHERE m.id=a.id
		AND a.auth_name=#{authName}
		AND m.remove_user_date IS NULL
		AND rnum between #{pagingBean.startRowNumber} and #{pagingBean.endRowNumber} 
	</select>
	
		<!-- 회원(ROLE_ARTIST) 리스트 불러오기 -->
	<select id="getManageMemberArtistList" resultMap="memberList" parameterType="map">
		SELECT m.id,m.nickname,m.address,m.phone,m.email,m.name,m.age,a.auth_name
		FROM (SELECT row_number() over(order by id desc) as rnum,auth_name,id
		FROM os_auth) a,os_member m, os_artist t
		WHERE m.id=a.id AND m.id=t.id
		AND a.auth_name=#{authName}
		AND t.check_date IS NOT NULL
		AND m.remove_user_date IS NULL
		AND rnum between #{pagingBean.startRowNumber} and #{pagingBean.endRowNumber} 
	</select>
	
</mapper>