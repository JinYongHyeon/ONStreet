<?xml version="1.0" encoding="UTF-8"?>
<!-- Sql Mapper -->
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.kosta.onstreet.model.mapper.BoardMapper">
 	
 	<resultMap type="artistVO" id="artistList">
 		<result column="id" property="memberVO.id"/>
 		<result column="password" property="memberVO.password"/>
 		<result column="nickname" property="memberVO.nickName"/>
 		<result column="address" property="memberVO.address"/>
 		<result column="phone" property="memberVO.phone"/>
 		<result column="email" property="memberVO.email"/>
 		<result column="name" property="memberVO.name"/>
 		<result column="age" property="memberVO.age"/>
 		<result column="remove_user_date" property="memberVO.removeUserDate"/>
 		<result column="profile" property="memberVO.profile"/>
 	</resultMap>
 	
 	<!-- 정지윤 -->
 	<select id="getTotalArtistCount" resultType="int">
		select count(*) from os_artist
	</select>
 	<!-- 아티스트 리스트 불러오기 -->
 	<select id="getArtistList" resultMap="artistList" parameterType="pagingBean">
 		SELECT m.nickname, m.profile
 		FROM(SELECT row_number() over(order by check_date desc) as rnum, check_date, id
 		FROM os_artist) t, os_member m, os_auth a
		WHERE m.id=a.id AND m.id=t.id 
		AND a.auth_name='ROLE_ARTIST' AND t.check_date is not null
		AND rnum between #{startRowNumber} and #{endRowNumber} 
		ORDER BY t.check_date DESC 
 	</select>

 	<!-- 이동욱 시작 -->
 	<!-- 게시물 전체 갯수 불러오는 sql -->
 	<select id="getTotalShowCount" resultType="int">
		select count(*) from os_show
	</select>
	<select id="getShowList" parameterType="pagingBean" resultType="showVO">
		SELECT s.rnum,s.show_title,m.nickname,s.show_date FROM(
		SELECT row_number() over(order by show_no desc) as rnum,show_no,show_title,
		to_char(show_date,'YYYY.MM.DD') as show_date,id
		FROM os_show
		) s,os_member m where s.id = m.id and rnum between #{startRowNumber} and #{endRowNumber} 
		order by rnum desc 
	</select>

</mapper>