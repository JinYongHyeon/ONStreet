<?xml version="1.0" encoding="UTF-8"?>
<!-- Sql Mapper -->
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.kosta.onstreet.model.mapper.BoardMapper">
 	<!-- 이동욱 시작 -->
 	<!-- board resultmap 설정 -->
 	<resultMap type="showVO" id="showListRM">
		<result property="artistVO.memberVO.id" column="id"/>
		<result property="artistVO.memberVO.nickName" column="nickname"/>
	</resultMap>
 	<!-- 공연일정글 전체 갯수 불러오는 sql -->
 	<select id="getTotalShowCount" resultType="int">
		select count(*) from os_show
	</select>
	<!-- 공연일정 전체글 리스트 불러오기 -->
	<select id="getShowList" parameterType="pagingBean" resultMap="showListRM">
		SELECT s.show_no,s.rnum,s.show_title,m.nickname,s.show_date FROM(
		SELECT row_number() over(order by show_date desc) as rnum,show_no,show_title,
		to_char(show_date,'YYYY.MM.DD') as show_date,id
		FROM os_show
		) s,os_member m where s.id = m.id and rnum between #{startRowNumber} and #{endRowNumber} 
		order by show_date desc 
	</select>
	<!-- 공연일정 상세보기 -->
	<select id="getShowDetail" parameterType="String" resultMap="showListRM">
		select s.id,s.show_no,s.show_title,s.show_img,to_char(s.show_write_date,'YYYY.MM.DD') as show_write_date,s.show_content,to_char(s.show_date,'YYYY.MM.DD') as show_date,m.nickname
		from OS_SHOW s, OS_member m 
		where s.id= m.id and show_no=#{value}
	</select>
</mapper>